<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="plantilla/template :: head">
</head>
<body class="sb-nav-fixed">

	<header th:replace="plantilla/template :: header"></header>

	<div id="layoutSidenav">

		<div th:replace="plantilla/template :: sidenav_nav"></div>

		<div id="layoutSidenav_content">

			<div class="container-fluid px-4 mt-3">

				<h1 class="">Administrar Vehículos</h1>
				<ol class="breadcrumb mb-3">
					<li class="breadcrumb-item active"><i class="fa-solid fa-car"></i>
						Vehículos</li>
				</ol>

				<div class="row d-md-flex justify-content-center">

					<div class="col-8" id="editarCard" style="display: none;">
						<div class="card">
							<div class="card-header bg-dark text-white" id="tituloCard">Editar
								Vehículo:</div>

							<div class="card-body row mb-2">

								<div class="col-6">

									<label>Marca:</label> <input type="text" id="editMarca"
										class="form-control"> <label class="mt-2">Modelo:</label>
									<input id="editModelo" type="text" class="form-control">
									<label class="mt-2">Patente:</label> <input id="editPat"
										type="text" class="form-control"> <label class="mt-2">Activo:</label>
									<select id="editActivo" class="form-select">
										<option value=1 selected>Sí</option>
										<option value=0>No</option>
									</select>


								</div>
								<div class="col-6 mt-2">

									<div class="d-md-flex justify-content-center mt-4  g-0 ">
										<div class="col-md-6">
											<img id="file-ip-1-preview" src="/images/vehiculo.png"
												width="100%" height="auto">
										</div>
									</div>

								</div>

							</div>


							<div
								class="card-footer d-md-flex justify-content-between bg-dark text-white">
								<button class="btn btn-secondary" onclick="cerrarNuevo()">Cancelar</button>
								<button class="btn btn-primary">Guardar</button>
							</div>

						</div>

					</div>

				</div>

				<div class="card mb-4 mt-3">
					<div class="card-header d-md-flex justify-content-between">
						<div class="">
							<i class="fa-solid fa-table mt-2"></i> Listado de Vehículos:
						</div>
						<div>
							<button class="btn btn-primary btn-sm" onclick="nuevoCard()">Nuevo
								Vehículo</button>
						</div>
					</div>
					<div class="card-body">

						<table id="table_id" class="display">
							<thead>
								<tr>
									<th>Marca</th>
									<th>Modelo</th>
									<th>Patente</th>
									<th>Activo</th>
									<th>Acción</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>Renault</td>
									<td>R9</td>
									<td>RDF-123</td>
									<td>Sí</td>
									<td>
										<button class="btn btn-sm btn-success btn-editar">Editar</button>
									</td>
								</tr>
								<tr>
									<td>Mazda</td>
									<td>X2</td>
									<td>AGE-523</td>
									<td>Sí</td>
									<td>
										<button class="btn btn-sm btn-success btn-editar">Editar</button>
									</td>
								</tr>

								<tr>
									<td>Ford</td>
									<td>C2-1</td>
									<td>JHG-345</td>
									<td>No</td>
									<td>
										<button class="btn btn-sm btn-success btn-editar">Editar</button>
									</td>
								</tr>

							</tbody>
						</table>

					</div>
				</div>


			</div>

		</div>

	</div>

	<footer th:replace="plantilla/template :: footer"></footer>

	<script type="text/javascript">
		var datatable;

		$(document).ready(function() {

			datatable = $('#table_id').DataTable({
				language : {
					"decimal" : "",
					"emptyTable" : "No hay información",
					"info" : "Mostrando _START_ a _END_ de _TOTAL_ Vehículos",
					"infoEmpty" : "Mostrando 0 to 0 of 0 Entradas",
					"infoFiltered" : "(Filtrado de _MAX_ total entradas)",
					"infoPostFix" : "",
					"thousands" : ",",
					"lengthMenu" : "Mostrar _MENU_ Vehículos",
					"loadingRecords" : "Cargando...",
					"processing" : "Procesando...",
					"search" : "Buscar:",
					"zeroRecords" : "Sin resultados encontrados",
					"paginate" : {
						"first" : "Primero",
						"last" : "Ultimo",
						"next" : "Siguiente",
						"previous" : "Anterior"
					}
				},
				"columnDefs" : [ {
					"className" : "dt-center",
					"targets" : "_all"
				} ]
			});
		});

		function nuevoCard() {

			$("#editModelo").val("");
			$("#editMarca").val("");
			$("#editPat").val("");
			$("#editActivo").val(1);

			$("#tituloCard").text("Crear Nuevo Vehículo");
			$("#file-ip-1-preview").attr('src', "/images/vehiculo.png");

			$("#editarCard").show();

		}

		$("#table_id tbody").on("click", '.btn-editar', function() {
			let filaSeleccionada = (this).closest("tr");
			let data = datatable.row(filaSeleccionada).data();

			$("#editMarca").val(data[0]);
			$("#editModelo").val(data[1]);
			$("#editPat").val(data[2]);
			$("#editActivo").val(data[3] == "Sí" ? 1 : 0);

			$("#tituloCard").text("Editar Vehículo");

			$("#editarCard").show();
		});

		function cerrarNuevo() {

			$("#editImagen").val("");

			$("#editarCard").hide();
		}
	</script>
</body>
</html>